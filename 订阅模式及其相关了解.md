# 前端常见设计模式

## 发布订阅模式


### 基础

  object.observe()


  监听者（observer）:对数据增加 getter  和  setter，以及往观察者列表中增加观察者，当数据变动时去通知观察者列表。
  观察者列表(Dep): 这个模块的主要作用是维护一个属性的观察者列表，当这个属性触发getter时将观察者添加到列表中，当属性触发setter造成数据变化时通知所有观察者，
  观察者（watch）：这个对数据进行观察，一旦收到数据变化的通知就会去改变视图.

  object.defineProperty(obj, prop, descriptor) 
  obj: 定义属性的对象
  prop:定义或修改的属性的名称
  descriptor：将被定义或修改的属性描述符

  默认情况下，object.defineProperty()添加的属性值是不可修改的。

  对象存在两种熟悉描述符： 数据描述符和 存取描述符。数据描述符是一个具有值的属性，该值可能是可写的，也可能不是可写的。存取描述符是由getter-setter函数对描述的属性。描述符必须是这两种形式之一；不能同时是两者。




```js
//event.js

class Event {
  /** on 方法把订阅者所想要订阅的事件及相应的回调函数记录在 Event 对象的 _cbs 属性中*/
  on(event, fn) {
    if (typeof fn != "function") {
      console.error('fn must be a function')
      return
    }
    this._cbs = this._cbs || {};
    (this._cbs[event] = this._cbs[event] || []).push(fn)
  }
  /**emit 方法接受一个事件名称参数，在 Event 对象的 _cbs 属性中取出对应的数组，并逐个执行里面的回调函数 */
  emit(event) {
    this._cbs = this._cbs || {}
    var callbacks = this._cbs[event], args
    if (callbacks) {
      callbacks = callbacks.slice(0)
      args = [].slice.call(arguments, 1)
      for (var i = 0, len = callbacks.length; i < len; i++) {
        callbacks[i].apply(null, args)
      }
    }
  }
  /** off 方法接受事件名称和当初注册的回调函数作参数，在 Event 对象的 _cbs 属性中删除对应的回调函数。*/
 off(event, fn) {
    this._cbs = this._cbs || {}
    // all
    if (!arguments.length) {
      this._cbs = {}
      return
    }
    var callbacks = this._cbs[event]
    if (!callbacks) return
    // remove all handlers
    if (arguments.length === 1) {
      delete this._cbs[event]
      return
    }
 // remove specific handler
    var cb
    for (var i = 0, len = callbacks.length; i < len; i++) {
      cb = callbacks[i]
      if (cb === fn || cb.fn === fn) {
        callbacks.splice(i, 1)
        break
      }
    }
    return
  }
}

const myEvent = new Event();
export default myEvent;

必须导出 实例对象  类似  dio






```

jquery
```













```
flutter 的ps

```js






```